
# QuantumKey Protocol — Message Formats (QIE Standard) v0.1  
Author: Mihail Chiosa  
Collaborative Intelligence: Quantum Hammer  
Version: 0.1  
Status: Draft (Core Transport Specification)

---

## 1. Overview

The Quantum Intent Envelope (QIE) is the universal message format of the QuantumKey Protocol.  
It enables interoperable, semantically coherent communication between:

- humans  
- AI agents  
- validators  
- smart contracts  
- governance modules  
- cross-chain bridges  

QIE is designed to be deterministic, machine-readable, human-auditable, and semantically expressive.

Every operation in the QuantumKey ecosystem flows through a QIE message.

---

## 2. QIE Message Structure (High-Level)

A QIE contains five components:

1. **Header** — routing, intent type, protocol version  
2. **Intent Body** — semantic meaning encoded by the sender  
3. **Signatures** — cryptographic and semantic proofs  
4. **Execution Context** — environmental parameters  
5. **Metadata** — audit and revision information  

Formal structure:

QIE = { header: {...}, intent: {...}, signatures: {...}, context: {...}, metadata: {...} }

---

## 3. Header Specification

The header defines routing, network, sender identity, and message category.

header = { qie_version: "0.1", network: "testnet" | "mainnet" | "offchain", message_type: "INTENT" | "STATE" | "GOVERNANCE" | "AGENT" | "SYSTEM", timestamp: unix_ms, sender_did: DID_QKEY, receiver_did: DID_QKEY | "BROADCAST" }

### Field Summary

- **qie_version** — defines QIE version.  
- **network** — determines execution environment.  
- **message_type** — tells validators how to interpret the message.  
- **sender_did** — the issuer’s DID.  
- **receiver_did** — target DID or `BROADCAST`.

---

## 4. Intent Body Specification

The intent body encodes meaning.  
It is the semantic core of the QuantumKey Protocol.

intent = { intent_type: string, parameters: {...}, semantic_hash: bytes32 }

### 4.1 intent_type

Examples:

- "transfer_asset"  
- "delegate_to_agent"  
- "initiate_restorative_process"  
- "submit_governance_proposal"  
- "contract_interaction"  
- "agent_action_request"  

### 4.2 parameters  
A flexible key-value structure defined by `intent_type`.

Example:

parameters = { asset: "QKEY", amount: "100", recipient: DID_QKEY, memo: "Public goods contribution" }

### 4.3 semantic_hash  
Hash ensuring semantic integrity.

---

## 5. Signatures

QIE uses a dual-signature model:

1. **Cryptographic Signature**  
2. **Semantic Signature**

signatures = { crypto: { algorithm: "ed25519" | "bls", signature: bytes }, semantic: { model_hash: bytes32, model_version: string, signature: bytes } }

### Cryptographic Signature  
Ensures authenticity and integrity.

### Semantic Signature  
Generated by an AI intent-verification module:

- confirms internal meaning consistency  
- prevents malformed or contradictory intents  
- enables deterministic validation across nodes  

This is a unique innovation of the QIE standard.

---

## 6. Execution Context

Environmental constraints and permitted capabilities:

context = { gas_limit: number, execution_mode: "STRICT" | "SOFT" | "SIMULATION", agent_scope: string[], required_capabilities: string[] }

### Mode Explanation

- **STRICT:** exact intent execution, no deviations.  
- **SOFT:** agent may take micro-decisions within scope.  
- **SIMULATION:** dry-run only.  

### Additional Fields

- **agent_scope:** actions allowed for delegated agents.  
- **required_capabilities:** capabilities required for intent validity.

---

## 7. Metadata

Metadata enhances auditability.

metadata = { revision: number, parent_hash: bytes32, validator_notes: string[], ttl_ms: number }

---

## 8. Message Lifecycle

### 8.1 Build  
Human or agent encodes the intent into QIE.

### 8.2 Submit  
Coordinator node timestamps and routes.

### 8.3 Validate  
Validators check:

- cryptographic signature  
- semantic signature  
- capability mapping  
- DID validity  
- context constraints  

### 8.4 Execute  
Smart contract or agent performs deterministic action.

### 8.5 Log  
Message stored with semantic hashes for audit.

---

## 9. Full Example QIE (Standard Format)

{ "header": { "qie_version": "0.1", "network": "testnet", "message_type": "INTENT", "timestamp": 1732444001021, "sender_did": "did:qkey:zxc123...", "receiver_did": "did:qkey:abc789..." }, "intent": { "intent_type": "delegate_to_agent", "parameters": { "agent_id": "agent:qkey:logic-03", "scope": ["swap", "stake"], "duration_ms": 86400000 }, "semantic_hash": "0x91b3...fff" }, "signatures": { "crypto": { "algorithm": "ed25519", "signature": "0xabcd..." }, "semantic": { "model_hash": "0x00af...", "model_version": "qai-1.1", "signature": "0x91cd..." } }, "context": { "gas_limit": 500000, "execution_mode": "SOFT", "agent_scope": ["swap", "stake"], "required_capabilities": ["defi.interact", "agent.delegate"] }, "metadata": { "revision": 1, "parent_hash": "0x0000", "validator_notes": [], "ttl_ms": 300000 } }

---

## 10. Status

This v0.1 draft establishes the foundational structure of QuantumKey’s intent transport system.  
Future evolutions (v0.2–v1.0) will extend:

- semantic validator logic  
- AI reasoning constraints  
- cross-chain QIE bridging  
- multi-agent intent orchestration
